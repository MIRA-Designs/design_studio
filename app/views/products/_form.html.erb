<%= render partial: "layouts/error", locals: { errors: @product.errors, record: 'Product' } %>

<%= form_with(model: @product, class: "form-product") do |form| %>
  <!-- Brand -->
  <div class="mb-4 animate-fade-in-up">
    <%= form.label :brand, "Brand", class: "block font-medium text-gray-700" %>
    <%= form.text_field :brand, class: "text-field" %>
  </div>

  <!-- Name -->
  <div class="mb-4 animate-fade-in-up">
    <%= form.label :name, "Name", class: "block font-medium text-gray-700" %>
    <%= form.text_field :name, class: "text-field" %>
  </div>

  <!-- Description -->
  <div class="mb-4 animate-fade-in-up">
    <%= form.label :description, "Description", class: "block font-medium text-gray-700" %>
    <%= form.rich_text_area :description, class: "text-area" %>
  </div>

  <!-- Images Upload -->
  <div class="mb-4 animate-fade-in-up">
    <%= form.label :images, "Product Images", class: "block font-medium text-gray-700" %>
    <%= form.file_field :images, multiple: true,
      class: "file-field" %>
  </div>

  <!-- Product Images Section -->
  <div class="mt-4">
    <div class="flex flex-wrap gap-2 mt-2">
      <% @product.persisted? && @product.images.each do |image| %>
        <%= image_tag image.variant(:thumb), alt: "Product Image", class: "w-24 h-24 object-cover rounded-md border border-gray-300" %>
      <% end %>
    </div>
  </div>

  <!-- Category -->
<div class="mb-4 animate-fade-in-up">
  <%= form.label :category, "Category", class: "block font-medium text-gray-700 mb-1" %>
  <%= form.select :category, product.class::CATEGORIES,
        { prompt: "Select a Category" },
        class: "select-field" %>
</div>


  <!-- Rating -->
<div class="mb-4 animate-fade-in-up">
  <%= form.label :rating, "Rating", class: "block font-medium text-gray-700 mb-1" %>
  <%= form.number_field :rating,
        in: 1.0..5.0,
        step: 0.5,
        class: "input-field number-field" %>
</div>

  <!-- Variant Fields -->
  <fieldset class="mt-6 p-4 border rounded-lg shadow-inner bg-orange-50">
    <legend class="text-md font-semibold text-orange-700 mb-4">Primary Variant</legend>

    <%= form.fields_for @variant do |variant_fields| %>
      <!-- SKU -->
      <div class="mb-4">
        <%= variant_fields.label :sku, "SKU", class: "block font-medium text-gray-700" %>
        <%= variant_fields.text_field :sku, class: "input-field" %>
      </div>

      <!-- MRP -->
      <div class="mb-4">
        <%= variant_fields.label :mrp, "MRP (â‚¹)", class: "block font-medium text-gray-700" %>
        <%= variant_fields.text_field :mrp, class: "input-field" %>
      </div>

      <!-- Discount Percent -->
      <div class="mb-4">
        <%= variant_fields.label :discount_percent, "Discount (%)", class: "block font-medium text-gray-700" %>
        <%= variant_fields.text_field :discount_percent, class: "input-field" %>
      </div>

      <!-- Size -->
      <div class="mb-4">
        <%= variant_fields.label :size, "Size", class: "block font-medium text-gray-700" %>
        <%= variant_fields.text_field :size, class: "input-field" %>
      </div>

      <!-- Color -->
      <div class="mb-4">
        <%= variant_fields.label :color, "Color", class: "block font-medium text-gray-700" %>
        <%= variant_fields.text_field :color, class: "input-field" %>
      </div>

      <!-- Stock Quantity -->
      <div class="mb-4">
        <%= variant_fields.label :stock_quantity, "Stock Quantity", class: "block font-medium text-gray-700" %>
        <%= variant_fields.number_field :stock_quantity, class: "input-field" %>
      </div>

      <!-- Specs (optional JSONB as YAML) -->
      <div class="mb-4">
        <%= variant_fields.label :specs, "Specifications (as JSON)", class: "block font-medium text-gray-700" %>
        <%= variant_fields.text_area :specs, value: variant_fields.object.specs.to_json, rows: 4, class: "input-field font-mono text-sm" %>
      </div>
    <% end %>
  </fieldset>

  <!-- Submit -->
  <div class="mt-6">
    <%= form.submit "Save Product", class: "btn-save" %>
  </div>
<% end %>
